<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<style>
    .cY{
        color: gold;
        font-size: large;
    }
    .logoXA{

        display: flex;
        flex-wrap: nowrap;
        flex-direction: column;
        justify-content: center;

    }
    .bg-image{
        /* background-image: url('https://juegalabolita.com/LoteriaMexicanaWeb/Content/img/loteria/consulta_carton_mexico.png');
        background-size: cover;
        background-position-x: right;
        background-repeat: no-repeat;
        background-origin: content-box; */
    }
</style>

<body>
    <div class="bg-danger d-flex justify-content-center align-items-center">

        <div class="bg-white p-5 text-secondary d-flex align-items-center flex-column ph" style="width:50rem;">
            <div>
                <img src="https://juegalabolita.com/absolutenm/articlefiles/1401-xazar.png" alt="" style="width: 150px; height: 120px;">
            </div>
            <div>
                
                <iframe src="https://www.google.com/maps/d/u/0/embed?mid=1d4GfU35luwHejTPh8xy7HE0l6cxnXVw&ehbc=2E312F" height="300" width="500" frameborder="0" allowfullscreen style="border:0;" allowfullscreen="" aria-hidden="false" tabindex="0"></iframe></iframe>
            </div>
            <div class="bgLM">
                <div class="text-center">
                    En <span class="cY">Xazar</span> somos un equipo experto en juegos y sorteos con más de 10 años de experiencia 
                    en el mercado de juegos y sorteos, mismos durante los cuales hemos operado el
                    <div>
                        <b>PERMISO de SEGOB DGAJS/SCEVF/P-01/2006.</b>
                    </div>
                    <div>
                        En este periodo hemos desarrollado diferentes juegos con los cuales hemos ido ganando cada vez más clientes
                        y vendedores a lo largo de los 30 estados de la República en donde nos encontramos.
                    </div>
                    <div>
                        Tenemos un equipo experto de desarrollo y soporte, así como uno de los mejores sites del Surestes, el cual almacena y resguarda
                        con total confiabilidad y seguridad toda nuestra información con equipos de última generación y tecnología de punta.
                    </div>
                    <div>
                        Contamos con un Know How único en nuestros sistemas de tecnología, esquemas de venta, cobertura de puntos de venta y oferta de juegos
                        lo cual nos permite posicionarnos como una de los mejores opciones en el País, en lo que se refiere a juegos y sorteos.
                    </div>
                </div>
                <h2 style="text-align: center;">Sucursales La Bolita</h2>
                <div class="row">
                    <div class="col-12">
                        <iframe id="mapaIframe" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3818.356019455189!2d-99.91574849999999!3d16.8582741!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x85caf7f7ac9580cb%3A0x9cb431b5057f64ef!2sCHEDRAUI%20PIE%20DE%20LA%20CUESTA!5e0!3m2!1ses-419!2smx!4v1691093991413!5m2!1ses-419!2smx" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                    <div class="col-6">
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                              <label class="input-group-text" for="estado">Estado</label>
                            </div>
                            <select class="custom-select" id="estado">
                              <option selected value="">Estado</option>
                            </select>
                        </div>    
                    </div>
                    <div class="col-6">
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                              <label class="input-group-text" for="municipio">Municipio</label>
                            </div>
                            <select class="custom-select" id="municipio">
                              <option selected value="">Municipio</option>
                            </select>
                        </div>    
                    </div>
                </div>
                <div id="oficinas">
                </div>
            </div>
        </div>
    </div>    

    <!-- <script>
        function updateOficinas(){
            var selectedEstado    = $("#estado").val();
            var selectedMunicipio = $("#municipio").val();

            var filteredOficinas = offices.filter(
                (office) =>
                            office.estado == selectedEstado && office.municipio == selectedMunicipio
            );
            $("#oficinas").empty();
            filteredOficinas.forEach(function (office){
                $("#oficinas").append(`
                    <div class="container">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card mb-3">
                                    <div class="row g-0">
                                        <div class="col-md-6">
                                            <div class="card-body text-center">
                                                <h5 class="card-title">${office.nombre}</h5>
                                                <p class="card-text">${office.estado}</p>
                                            </div>
                                        </div>
                                        <div class="col-md-3 d-flex justify-content-center align-items-center pt-3 pb-3">
                                            <div class="text-center d-flex align-items-center">
                                                <img class="img-fluid" src="https://img.icons8.com/external-vitaliy-gorbachev-lineal-color-vitaly-gorbachev/60/external-open-ecommerce-vitaliy-gorbachev-lineal-color-vitaly-gorbachev.png" alt="external-open-ecommerce-vitaliy-gorbachev-lineal-color-vitaly-gorbachev"/>
                                                <p class="card-text ml-1"><small class="text-muted">9:00am - 9:00pm</small></p>
                                            </div>
                                        </div>
                                        <div class="col-md-3 d-flex justify-content-center align-items-center bg-image pt-3 pb-3">
                                            <button class="actualizarMapa btn btn-success btn-lg" data-src="${office.direccion}">Ubicación</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `);
            });
        }

        function updateMunicipios(){
            var selectedEstado = $("#estado").val();
            var uniqueMunicipios = new Set();

            offices
                .filter((office) => office.estado == selectedEstado)
                .forEach((office)=> {
                    uniqueMunicipios.add(office.municipio);
                });

                var municipiosArray = Array.from(uniqueMunicipios);


            // Limpia el dropdown de municipios
            $("#municipio").empty();

            // Agrega los municipios correspondientes al dropdown
            municipiosArray.forEach(function (municipio) {
                $("#municipio").append(
                    $("<option>", {
                    value: municipio,
                    text: municipio,
                    })
                );
            });

            // Actualiza las oficinas al seleccionar el estado
            updateOficinas();
        }   
        // Ejecuta la función al cargar la página para mostrar los municipios del primer estado
        $(document).ready(function () {
            updateMunicipios();

            //Agrega eventos para actualizar las oficinas cuando se seleccione un estado o municipio
            $("#estado").change(updateMunicipios);
            $("#municipio").change(updateOficinas);

            $(document).on("click", ".actualizarMapa", function(){
                var nuevaUbicacion = $(this).data("src");
                $("#mapaIframe").attr("src", nuevaUbicacion);
                console.log('Botón de ubicación clickeado');
            });
        });
    </script> -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        const api = axios.create({
            baseURL: 'https://api.juegalabolita.com/api/location/',
            headers:{
                'accept': 'application/json;charset=utf-8',
            },
        });

        async function populateDropdown(elementId, data, defaultOptionText = null){
            const dropdown = document.getElementById(elementId);
            dropdown.innerHTML = '';
            
            if(defaultOptionText != null){
                const defaultOption = new Option(defaultOptionText, '');
                dropdown.appendChild(defaultOption);
            }

            data.forEach(item => {
                const option  = new Option(item.description, item.id)
                dropdown.appendChild(option);
            });
        }

        async function municipiosByEstadoId(estadoId){
            try {
                const response   = await api.get(`GetMunicipios/${estadoId}`);
                const municipios = response.data;
                
                populateDropdown('municipio', municipios);
            } catch (error) {
                console.error('An error occurred:', error);
            }
        }

        async function fillDropdownByState(){
            try {
                const response = await api.get('GetEstados');
                const estados  = response.data;
                
                populateDropdown('estado', estados, 'Estado');

                const estadoDropdown = document.getElementById('estado');
                estadoDropdown.addEventListener('change', (event) =>{
                    const selectedEstadoId = event.target.value;
                    if (selectedEstadoId) {
                        municipiosByEstadoId(selectedEstadoId);
                    } else {
                        populateDropdown('municipio', [])
                    }
                });

            } catch (error) {
                console.error('An error occurred:', error);
            }
        }
        fillDropdownByState();

    </script>
</body>

</html>